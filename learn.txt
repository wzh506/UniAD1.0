

1.环境复用了torch201

2.evaluation
./tools/uniad_dist_eval.sh ./projects/configs/stage1_track_map/base_track_map.py ./ckpts/uniad_base_track_map.pth 8


3.train

./tools/uniad_dist_train.sh ./projects/configs/stage1_track_map/base_track_map.py 8
./tools/uniad_dist_train.sh ./projects/configs/stage2_e2e/base_e2e_vla.py 8

./tools/uniad_dist_train.sh ./projects/configs/stage2_e2e/base_e2e.py 8 > val.log 2>&1

tmux attach -t
4.eval

./tools/uniad_dist_eval.sh ./projects/configs/stage2_e2e/base_e2e.py  ./ckpts/uniad_base_e2e.pth 8

./tools/uniad_dist_eval.sh ./projects/configs/stage2_e2e/base_e2e_vla.py /home/lucian.wang/github/UniAD1.0/projects/work_dirs/stage2_e2e/base_e2e_vla/epoch_20.pth 8 > eval.log 2>&1


5.visualize
# please refer to  nohup bash ./tools/uniad_vis_result.sh > vis2.log 2>&1 &
python ./tools/analysis_tools/visualize/run.py \
    --predroot /PATH/TO/YOUR/RESULTS.pkl \
    --out_folder /PATH/TO/YOUR/OUTPUT \
    --demo_video test_demo.avi \
    --project_to_cam True


6.问题
mmcv文件夹的名字和mmcv库发生冲突，导致运行时报错
mmcv测试：python -c "from mmcv.ops import nms_match; print(nms_match)"
原代码发现没有调通多进程分布式运算，我进行了相应修改
现在代码可以运行，不过发现v2.0的和现有ckpt不是很合适


7.压缩
tar -czf val4.tar.gz /home/lucian.wang/github/UniAD1.0/output/visualizations_val4

8.视频生成：
ffmpeg -r 10 -pattern_type glob -i '*.jpg' -vf fps=10,'crop=trunc(iw/2)*2:trunc(ih/2)*2' -vcodec libx264 infer.mp4 -y

ba4c6f0403354126baa8b3cae42c99fc